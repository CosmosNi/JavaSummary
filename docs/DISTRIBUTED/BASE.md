# 分布式

分布式系统：是一个硬件或软件分布在不同的网络计算机上，彼此之间只通过消息传递进行通信和协调的系统。

特点：

1. 分布性：分布式系统中的多台计算机都在空间上随意分布。

2. 对等性:分布式系统中的计算机没有主从之分，组成分布式系统的所有计算机节点都是对等的。
3. 并发性：分布式系统的多个节点，可能并发的操作一些共享的数据。
4. 缺乏全局时钟：在分布式系统中，很难定义两个事件究竟谁先谁后，原因就是分布式系统缺乏一个全局的时钟序列控制。
5. 故障总是会发生：组成分布式系统的所有计算机，都有可能发生任何形式的故障。





###### 1.1 分布式锁的实现

- 数据库表：通过在锁表中增加记录，想要释放锁就删除这条记录。（依赖于数据库的可用性，无法保证一定能释放锁）
- 数据库排它锁：如mysql的sql查询语句增加for update（无法解决单点和可重入问题）。
- 缓存实现：基于redis等缓存工具。通过设置失效时间。（可以避免单点问题以及提供更好的性能，但通过超时时间来控制锁的失效时间并不是很靠谱）。
- 基于Zookeeper：每个客户端对某个方法加锁时，在Zookeeper上的与该方法对应的指定目录下，生成一个唯一的瞬时有序节点。判断是否获取锁的方式也很简单，只需要判断有序节点中序号最小的一个。当释放锁的时候，只需要将这个瞬时节点删除即可，同时，可避免服务宕机导致的锁无法释放，而产生的死锁问题。

